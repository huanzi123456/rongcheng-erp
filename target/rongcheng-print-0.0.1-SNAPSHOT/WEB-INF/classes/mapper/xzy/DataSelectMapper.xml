<?xml version="1.0" encoding="UTF-8" ?>  
<!DOCTYPE mapper PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"      
 "http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<!-- 
  <include refid="data_where_if"/>
  <include refid="data_if_link"/>
  <include refid="data_if_link_c"/>
  <include refid="data_if_code"/>
 -->
<mapper namespace="com.rongcheng.erp.dao.dataStatisticsDao.Xzy_DataSelectDao">
<!-- 
   1.订单统计报表 
     (1)订单总数
     (2)已发货的订单数 order_status字段的值是7 
     (3)待发货的订单数  order_status字段值在[2,6]之间的均是待发货
     (4)已关闭的订单数 refund_close字段值为2
     (5)成交额(暂时等于商品总价值)
     (6)客单价=成交额/客户数
-->
<!-- :(1)订单总数 :统计订单表的id的数量-->
<select id="seleTotalOrderBy" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam" resultType="Integer">
  SELECT COUNT(DISTINCT a.id)              
  FROM order_info a
  <include refid="data_where_if"/>
  <include refid="data_if_link"/>
</select>
<!-- :(2)已发货的订单数: order_status字段的值是7-->
<select id="seleOutGoodsBy" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam" resultType="Integer">
  SELECT COUNT(DISTINCT a.id)
  FROM order_info a 
  <include refid="data_where_if"/>
  <include refid="data_if_link"/>
  AND a.order_status = 7
</select>
<!-- :(3)待发货的订单数 : order_status字段值在[2,6]之间  -->
<select id="seleWaitGoodsBy" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam" resultType="Integer">
  SELECT COUNT(DISTINCT a.id)
  FROM order_info a 
  <include refid="data_where_if"/>
  <include refid="data_if_link"/>
  AND a.order_status IN (2,3,4,5,6)
</select>
<!-- :(4)已关闭的订单数 refund_close字段值为2 -->
<select id="seleOrderClosed" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam" resultType="Integer">
  SELECT COUNT(DISTINCT a.id)
  FROM order_info a 
  <include refid="data_where_if"/>
  <include refid="data_if_link"/>
  AND a.refund_close = 2
</select>
<!-- :(5)成交额(暂时等于商品总价值) -->
<!-- :(6)统计客户数(客单价=成交额/客户数)-->
<select id="seleClients" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam" resultType="Integer">
  SELECT SUM(t.counts) clients
  FROM (SELECT  a.platform_id,COUNT(DISTINCT a.platform_buyer_id) counts
        FROM order_info a     
        <include refid="data_where_if"/>
        <include refid="data_if_link"/>
        GROUP BY a.platform_id) t
</select>
<!-- 
  2.商品统计表
    (1)已发货的订单的商品总个数
    (2)未发货的订单的商品总个数
    (3)商品总数
    (4)商品总价值
    (5)商品平均价
    (6)商品总成本
 -->
 <!-- (1)已发货的订单的商品总个数 -->
<select id="seleGoodsNum" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam" resultType="Integer">
  SELECT COUNT(b.order_item_id) outGoods
  FROM order_info a
  JOIN order_item_link b
  ON b.erp_order_id=a.id
  <include refid="data_where_if"/>
  <include refid="data_if_link_c"/>
  AND a.owner_id=b.owner_id=#{owner_id}  
  AND a.order_status = 7
</select>
<!-- (2)未发货的订单的商品总个数 -->
<select id="seleWaitGoodsNum" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam" resultType="Integer">
  SELECT COUNT(b.order_item_id) outGoods
  FROM order_info a
  JOIN order_item_link b
  ON b.erp_order_id=a.id
  <include refid="data_where_if"/>
  <include refid="data_if_link_c"/>
  AND a.order_status IN (2,3,4,5,6)
  AND a.owner_id=b.owner_id=#{owner_id}
</select>
<!-- (3)商品总数,商品总价值,商品总成本 -->
<select id="selePrice" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam"
resultType="com.rongcheng.erp.dto.XzyDataSelectParam">
  SELECT SUM(t.quantity) quantity,SUM(t.price) price,SUM(t.costPrice) costPrice
  FROM (SELECT DISTINCT b.order_item_id,SUM(b.quantity) quantity,SUM(b.quantity)*c.normal_price price,SUM(b.quantity)*c.cost_price costPrice
        FROM order_item_link b
        JOIN item_common_info c
        ON b.order_item_id = c.id
        JOIN order_info a 
        ON b.erp_order_id=a.id     
        <include refid="data_where_if"/>
        <include refid="data_if_code"/> 
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id} 
        GROUP BY b.order_item_id
        ORDER BY b.quantity DESC) t
</select>
<!--  -->
<select id="seleSells" parameterType="com.rongcheng.erp.dto.XzyDataSelectParam"
resultType="com.rongcheng.erp.dto.XzyDataSelectParam">
  SELECT DISTINCT SUM(b.quantity) quantity,c.name
  FROM order_item_link b
  JOIN item_common_info c
  ON b.order_item_id = c.id
  JOIN order_info a 
  ON b.erp_order_id=a.id
  <include refid="data_where_if"/>
  <include refid="data_if_code"/>
  AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}         
  GROUP BY b.order_item_id
  LIMIT 0,20
</select>
<!-- 
  1.一个条件(8种)
    (1)day
    (2)dayCalendar
    (3)pay
    (4)payCalendar
    (5)shopId店铺id
    (6)platformId平台id
    (7)orderStatus原始订单状态
    (8)code
  2.两个条件(22种)
    (1)day+shopId
    (2)day+platformId
    (3)day+orderStatus
    (4)day+code
    (5)dayCalendar+shopId
    (6)dayCalendar+platformId
    (7)dayCalendar+orderStatus
    (8)dayCalendar+code
    (9)pay+shopId
    (10)pay+platformId
    (11)pay+orderStatus
    (12)pay+code
    (13)payCalendar+shopId
    (14)payCalendar+platformId
    (15)payCalendar+orderStatus
    (16)payCalendar+code
    (17)shopId+platformId
    (18)shopId+orderStatus
    (19)shopId+code
    (20)platformId+orderStatus
    (21)platformId+code
    (22)orderStatus+code
  3.三个条件(28种)
    (1)day+shopId+platformId
    (2)day+shopId+orderStatus
    (3)day+shopId+code
    (4)day+platformId+orderStatus
    (5)day+platformId+code
    (6)day+orderStatus+code
    (7)dayCalendar+shopId+platformId
    (8)dayCalendar+shopId+orderStatus
    (9)dayCalendar+shopId+code
    (10)dayCalendar+platformId+orderStatus
    (11)dayCalendar+platformId+code 
    (12)dayCalendar+orderStatus+code 
    (13)pay+shopId+platformId
    (14)pay+shopId+orderStatus
    (15)pay+shopId+code 
    (16)pay+platformId+orderStatus
    (17)pay+platformId+code
    (18)pay+orderStatus+code
    (19)payCalendar+shopId+platformId
    (20)payCalendar+shopId+orderStatus
    (21)payCalendar+shopId+code
    (22)payCalendar+platformId+orderStatus
    (23)payCalendar+platformId+code
    (24)payCalendar+orderStatus+code
    (25)platformId+shopId+orderStatus
    (26)platformId+shopId+code
    (27)platformId+orderStatus+code
    (28)shopId+orderStatus+code
  4.四个条件(17种)  
    (1)day+shopId+platformId+orderStatus
    (2)day+shopId+platformId+code
    (3)day+shopId+orderStatus+code
    (4)day+platformId+orderStatus+code
    (5)dayCalendar+shopId+platformId+orderStatus
    (6)dayCalendar+shopId+platformId+code
    (7)dayCalendar+shopId+orderStatus+code 
    (8)dayCalendar+platformId+orderStatus+code
    (9)pay+shopId+platformId+orderStatus
    (10)pay+shopId+platformId+code
    (11)pay+shopId+orderStatus+code
    (12)pay+platformId+orderStatus+code
    (13)payCalendar+shopId+platformId+orderStatus
    (14)payCalendar+shopId+platformId+code
    (15)payCalendar+shopId+orderStatus+code
    (16)payCalendar+platformId+orderStatus+code
    (17)platformId+shopId+orderStatus+code
  5.五个条件(4种)  
    (1)day+shopId+platformId+orderStatus+code
    (2)dayCalendar+shopId+platformId+orderStatus+code
    (3)pay+shopId+platformId+orderStatus+code
    (4)payCalendar+shopId+platformId+orderStatus+code
 --> 
<sql id="data_where_if">
   <where>   
    <!-- 1.一个条件(8种) -->
    <!-- (1)day -->
    <if test="day!=null and owner_id !=null and pay==null and shopId==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
		a.owner_id =#{owner_id}			 
		AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}				
	</if>
	<!-- (2)dayCalendar -->
    <if test="time1!='' and time2!='' and owner_id !=null and day == null and pay==null and shopId==null and platformId==null and time3=='' and time4=='' and orderStatus==null and code==''">
        a.owner_id =#{owner_id}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
    </if>
    <!-- (3)pay -->  
    <if test="pay != null and owner_id != null and day==null and shopId==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        a.owner_id =#{owner_id}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
    </if>
    <!-- (4)payCalendar -->
    <if test="time3!='' and time4!='' and owner_id !=null and day == null and pay==null and shopId==null and platformId==null and time1=='' and time2=='' and orderStatus==null and code==''">
        a.owner_id =#{owner_id}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})      
    </if>
    <!-- (5)shopId店铺id -->
    <if test="shopId==-1 and owner_id!=null and day==null and pay==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        a.owner_id =#{owner_id}        
    </if>
    <if test="shopId!=-1 and shopId!=null and owner_id!=null and day==null and pay==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        a.owner_id =#{owner_id}
        AND a.shop_id =#{shopId}
    </if>
    <!-- (6)platformId平台id -->
    <if test="platformId==-1 and owner_id!=null and day==null and pay==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        a.owner_id =#{owner_id}
    </if>
    <if test="platformId!=-1 and platformId!=null and owner_id!=null and day==null and pay==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        a.owner_id =#{owner_id}
        AND a.platform_id =#{platformId}
    </if>
    <!-- (7)orderStatus原始订单状态 -->
    <if test="orderStatus==-1 and owner_id!=null and day==null and pay==null and shopId==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and code==''">
         a.owner_id =#{owner_id}
         AND a.order_status IS NOT NULL
    </if>
    <if test="orderStatus!=null and orderStatus!=-1 and owner_id!=null and day==null and pay==null and shopId==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and code==''">
        a.owner_id =#{owner_id}
        AND a.order_status =#{orderStatus}
    </if>
    <!-- 2.两个条件(22种) -->
    <!-- (1)day+shopId -->
    <if test="day!=null and shopId!=null and owner_id !=null and pay==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">      
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.shop_id=#{shopId}
        AND a.owner_id=#{owner_id}      
    </if>
    <!-- (2)day+platformId -->
    <if test="day!=null and platformId!=null and owner_id !=null and pay==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.platform_id=#{platformId}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- (3)day+orderStatus -->
    <if test="day!=null and orderStatus!=null and owner_id !=null and pay==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and code==''">
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.order_status=#{orderStatus}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- 
      (4)day+code 关联查询,在where外面
      
      (5)dayCalendar+shopId
     -->
    <if test="time1!='' and time2!='' and shopId!=null and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null and orderStatus==null and code==''">
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.shop_id=#{shopId}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- (6)dayCalendar+platformId -->
    <if test="time1!='' and time2!='' and platformId!=null and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and shopId==null and orderStatus==null and code==''">
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.platform_id=#{platformId}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- (7)dayCalendar+orderStatus -->
    <if test="time1!='' and time2!='' and orderStatus!=null and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null and shopId==null and code==''">
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.order_status=#{orderStatus}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- 
      (8)dayCalendar+code 关联查询,在where外面
      (9)pay+shopId
     --> 
    <if test="pay!=null and shopId!=null and owner_id !=null and day==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.shop_id=#{shopId}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- (10)pay+platformId -->
    <if test="pay!=null and platformId!=null and owner_id !=null and day==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.platform_id=#{platformId}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- (11)pay+orderStatus -->
    <if test="pay!=null and orderStatus!=null and owner_id !=null and day==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and code==''">
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.order_status=#{orderStatus}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- 
      (12)pay+code 关联查询,在where外面
      (13)payCalendar+shopId
     -->
    <if test="time3!='' and time4!='' and shopId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and platformId==null and orderStatus==null and code==''">
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.shop_id=#{shopId}
        AND a.owner_id=#{owner_id} 
    </if>
    <!-- (14)payCalendar+platformId -->
    <if test="time3!='' and time4!='' and platformId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and shopId==null and orderStatus==null and code==''">
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.platform_id=#{platformId}
        AND a.owner_id=#{owner_id} 
    </if>
    <!-- (15)payCalendar+orderStatus -->
    <if test="time3!='' and time4!='' and orderStatus!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and shopId==null and platformId==null and code==''">
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.order_status=#{orderStatus}
        AND a.owner_id=#{owner_id}
    </if>
    <!-- 
      (16)payCalendar+code 关联查询,在where外面
      (17)shopId+platformId
     -->
    <if test="shopId!=null and shopId!=-1 and platformId!=null and platformId!=-1 and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code=='' and orderStatus==null">
        AND a.owner_id=#{owner_id}
        AND a.shop_id=#{shopId}
        AND a.platform_id=#{platformId}
    </if>
    <if test="shopId==-1 and platformId==-1 and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code=='' and orderStatus==null">
        AND a.owner_id=#{owner_id}
    </if>
    <!-- (18)shopId+orderStatus -->
    <if test="shopId!=null and shopId!=-1 and orderStatus!=null and orderStatus!=-1 and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code=='' and platformId==null ">
        AND a.owner_id=#{owner_id}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
    </if>
    <if test="shopId==-1 and orderStatus==-1 and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code=='' and platformId==null ">
        AND a.owner_id=#{owner_id}
        AND a.order_status IS NOT NULL
    </if>
    <!-- 
      (19)shopId+code 关联查询,在where外面
      (20)platformId+orderStatus
     -->
    <if test="platformId!=null and platformId!=-1 and orderStatus!=null and orderStatus!=-1 and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code=='' and shopId==null">
        AND a.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus} 
    </if>
    <if test="platformId==-1 and orderStatus==-1 and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code=='' and shopId==null">
        AND a.owner_id=#{owner_id}
        AND a.order_status IS NOT NULL
    </if>
    <!-- 
      (21)platformId+code 关联查询,在where外面
      (22)orderStatus+code 关联查询,在where外面
     -->   
    <!--  3.三个条件(28种) -->
    <!-- (1)day+shopId+platformId -->  
    <if test="day!=null and shopId!=null and platformId!=null and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.shop_id=#{shopId}
        AND a.platform_id=#{platformId}
    </if>
    <!-- (2)day+shopId+orderStatus -->
    <if test="day!=null and shopId!=null and orderStatus!=null and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and code==''">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
    </if>
    <!-- 
      (3)day+shopId+code 关联查询,在where外面
      (4)day+platformId+orderStatus
     -->
    <if test="day!=null and platformId!=null and orderStatus!=null and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and code==''">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
    </if>
    <!-- 
      (5)day+platformId+code 关联查询,在where外面
      (6)day+orderStatus+code 关联查询,在where外面
      (7)dayCalendar+shopId+platformId 
     -->
    <if test="time1!='' and time2!='' and shopId!=null and platformId!=null and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and code=='' and orderStatus==null">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.shop_id=#{shopId}
        AND a.platform_id=#{platformId}
    </if>
    <!-- (8)dayCalendar+shopId+orderStatus -->
    <if test="time1!='' and time2!='' and shopId!=null and orderStatus!=null and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and code=='' and platformId==null">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
    </if>
    <!-- 
      (9)dayCalendar+shopId+code 关联查询,在where外面
      (10)dayCalendar+platformId+orderStatus
     -->
    <if test="time1!='' and time2!='' and platformId!=null and orderStatus!=null and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and code=='' and shopId==null">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
    </if>
    <!-- 
      (11)dayCalendar+platformId+code 关联查询,在where外面
      (12)dayCalendar+orderStatus+code 关联查询,在where外面
      (13)pay+shopId+platformId
     -->
    <if test="pay!=null and shopId!=null and platformId!=null and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and code==''">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}       
        AND a.shop_id=#{shopId}
        AND a.platform_id=#{platformId}
    </if> 
    <!-- (14)pay+shopId+orderStatus -->
    <if test="pay!=null and shopId!=null and orderStatus!=null and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and code==''">
        AND a.owner_id =#{owner_id}		
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}	 
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
    </if>
    <!-- 
      (15)pay+shopId+code 关联查询,在where外面
      (16)pay+platformId+orderStatus
     -->
    <if test="pay!=null and platformId!=null and orderStatus!=null and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and code==''">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
    </if>
    <!-- 
      (17)pay+platformId+code 关联查询,在where外面
      (18)pay+orderStatus+code 关联查询,在where外面
      (19)payCalendar+shopId+platformId
     -->  
    <if test="time3!='' and time4!='' and shopId!=null and platformId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and code=='' and orderStatus==null">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.shop_id=#{shopId}
        AND a.platform_id=#{platformId}
    </if> 
    <!-- (20)payCalendar+shopId+orderStatus -->
    <if test="time3!='' and time4!='' and shopId!=null and orderStatus!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and code=='' and platformId==null">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
    </if>
    <!-- 
      (21)payCalendar+shopId+code 关联查询,在where外面
      (22)payCalendar+platformId+orderStatus
     -->
    <if test="time3!='' and time4!='' and platformId!=null and orderStatus!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and code=='' and shopId==null">
        AND a.owner_id =#{owner_id}			 
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
    </if>
    <!-- 
      (23)payCalendar+platformId+code 关联查询,在where外面
      (24)payCalendar+orderStatus+code 关联查询,在where外面
      (25)platformId+shopId+orderStatus
     -->
     <if test="platformId!=null and platformId!=-1 and shopId!=null and shopId!=-1 and orderStatus!=null and orderStatus!=-1 and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code==''">
         AND a.owner_id =#{owner_id}
         AND a.platform_id=#{platformId}
         AND a.shop_id=#{shopId}
         AND a.order_status=#{orderStatus}
     </if>
     <if test="platformId==-1 and shopId==-1 and orderStatus==-1 and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code==''">
         AND a.owner_id =#{owner_id}
         AND a.platform_id IS NOT NULL
         AND a.shop_id IS NOT NULL
         AND a.order_status IS NOT NULL
     </if>
     <!-- 
       (26)platformId+shopId+code 关联查询,在where外面
       (27)platformId+orderStatus+code 关联查询,在where外面
       (28)shopId+orderStatus+code 关联查询,在where外面
      -->
     <!--  4.四个条件(17种) -->
    <!-- (1)day+shopId+platformId+orderStatus --> 
    <if test="day!=null and shopId!=null and platformId!=null and orderStatus!=null and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and code==''">
        AND a.owner_id =#{owner_id}			 
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.order_status=#{orderStatus}                  
    </if>
    <!-- 
      (2)day+shopId+platformId+code 关联查询,在where外面
      (3)day+shopId+orderStatus+code 关联查询,在where外面
      (4)day+platformId+orderStatus+code 关联查询,在where外面
      (5)dayCalendar+shopId+platformId+orderStatus
     -->
     <if test="time1!='' and time2!='' and platformId!=null and shopId!=null and orderStatus!=null and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and code==''">
         AND a.owner_id =#{owner_id}
         AND a.platform_id=#{platformId}
         AND a.shop_id=#{shopId}			 
         AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
         AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
         AND a.order_status=#{orderStatus}         
     </if>
      <!-- 
       (6)dayCalendar+shopId+platformId+code 关联查询,在where外面
       (7)dayCalendar+shopId+orderStatus+code 关联查询,在where外面
       (8)dayCalendar+platformId+orderStatus+code 关联查询,在where外面
       (9)pay+shopId+platformId+orderStatus
      -->
     <if test="pay!=null and platformId!=null and shopId!=null and orderStatus!=null and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and code==''">
         AND a.owner_id =#{owner_id}			 
         AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}       
         AND a.shop_id=#{shopId}
         AND a.platform_id=#{platformId}
         AND a.order_status=#{orderStatus}
     </if>
     <!-- 
       (10)pay+shopId+platformId+code 关联查询,在where外面
       (11)pay+shopId+orderStatus+code 关联查询,在where外面
       (12)pay+platformId+orderStatus+code 关联查询,在where外面
       (13)payCalendar+shopId+platformId+orderStatus
      -->
     <if test="time3!='' and time4!='' and orderStatus!=null and platformId!=null and shopId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and code==''">
         AND a.owner_id =#{owner_id}
         AND a.platform_id=#{platformId}
         AND a.shop_id=#{shopId}			 
         AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
         AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
         AND a.order_status=#{orderStatus} 
     </if>
      <!-- 
       (14)payCalendar+shopId+platformId+code 关联查询,在where外面
       (15)payCalendar+shopId+orderStatus+code 关联查询,在where外面
       (16)payCalendar+platformId+orderStatus+code 关联查询,在where外面
       (17)platformId+shopId+orderStatus+code 关联查询,在where外面
      --> 	  
  </where> 
</sql>
<sql id="data_if_link">
  <!-- 1.(8)code -->
    <if test="code!='' and owner_id!=null and day==null and pay==null and shopId==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        where a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
    </if>
  <!-- 2.(4)day+code -->
  <if test="day!=null and code!='' and owner_id !=null and pay==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
  </if> 
  <!-- 2.(8)dayCalendar+code -->
  <if test="time1!='' and time2!='' and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null and shopId==null and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
  </if>
  <!-- 2.(12)pay+code -->
  <if test="pay!=null and code!='' and owner_id !=null and day==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
  </if>
  <!-- 2.(16)payCalendar+code 关联查询,在where外面 -->
  <if test="time3!='' and time4!='' and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and shopId==null and platformId==null and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
  </if>
  <!-- 2.(19)shopId+code -->
  <if test="shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 2.(21)platformId+code -->
  <if test="platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 2.(22)orderStatus+code -->
  <if test="orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and shopId==null ">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(3)day+shopId+code -->
  <if test="day!=null and shopId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(5)day+platformId+code -->
  <if test="day!=null and platformId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(6)day+orderStatus+code -->
  <if test="day!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(9)dayCalendar+shopId+code -->
  <if test="time1!='' and time2!='' and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(11)dayCalendar+platformId+code -->
  <if test="time1!='' and time2!='' and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(12)dayCalendar+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(15)pay+shopId+code -->
  <if test="pay!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(17)pay+platformId+code -->
  <if test="pay!=null and platformId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(18)pay+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.order_status=#{orderStatus} 
  </if>
  <!-- 3.(21)payCalendar+shopId+code -->
  <if test="time3!='' and time4!='' and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(23)payCalendar+platformId+code -->
  <if test="time3!='' and time4!='' and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(24)payCalendar+orderStatus+code -->
  <if test="time3!='' and time4!='' and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and platformId==null and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(26)platformId+shopId+code -->
  <if test="platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}     
  </if>
  <!-- 3.(27)platformId+orderStatus+code -->
  <if test="platformId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
  </if>
   <!-- 3.(28)shopId+orderStatus+code -->
  <if test="shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
  </if> 
  <!-- 4.(2)day+shopId+platformId+code -->
  <if test="day!=null and shopId!=null and platformId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}        
  </if>
  <!-- 4.(3)day+shopId+orderStatus+code -->
  <if test="day!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day} 
  </if>
  <!-- 4.(4)day+platformId+orderStatus+code -->
  <if test="day!=null and platformId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
  </if>
  <!-- 4.(6)dayCalendar+shopId+platformId+code 关联查询,在where外面 -->
  <if test="time1!='' and time2!='' and platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})      
  </if>
  <!-- 4.(7)dayCalendar+shopId+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})  
  </if>
  <!-- 4.(8)dayCalendar+platformId+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
  </if>
  <!-- 4.(10)pay+shopId+platformId+code -->
  <if test="pay!=null and platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}   
  </if>
  <!-- 4.(11)pay+shopId+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay} 
  </if>
  <!-- 4.(12)pay+platformId+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and platformId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
  </if>
  <!-- 4.(14)payCalendar+shopId+platformId+code -->
   <if test="time3!='' and time4!='' and code!='' and platformId!=null and shopId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(15)payCalendar+shopId+orderStatus+code -->
   <if test="time3!='' and time4!='' and code!='' and orderStatus!=null and shopId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and platformId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(16)payCalendar+platformId+orderStatus+code -->
   <if test="time3!='' and time4!='' and code!='' and orderStatus!=null and platformId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and shopId==null">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(17)platformId+shopId+orderStatus+code 关联查询,在where外面 -->
   <if test="shopId!=null and platformId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' ">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}        
   </if>
    <!--  5.五个条件(种) -->
   <!-- (1)day+shopId+platformId+orderStatus+code -->
   <if test="day!=null and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4==''">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
   </if>
   <!-- (2)dayCalendar+shopId+platformId+orderStatus+code -->
   <if test="time1!='' and time2!='' and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' ">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
   </if>
   <!-- (3)pay+shopId+platformId+orderStatus+code -->
   <if test="pay!=null and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4==''">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
   </if>
   <!-- (4)payCalendar+shopId+platformId+orderStatus+code -->
   <if test="time3!='' and time4!='' and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2==''">
        JOIN order_item_link b
        ON b.erp_order_id=a.id
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
</sql>
<sql id="data_if_link_c">
  <!-- 1.(8)code -->
    <if test="code!='' and owner_id!=null and day==null and pay==null and shopId==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">        		 					
        JOIN item_common_info c
        ON c.id = b.order_item_id
        where a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
    </if>
  <!-- 2.(4)day+code -->
  <if test="day!=null and code!='' and owner_id !=null and pay==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
  </if> 
  <!-- 2.(8)dayCalendar+code -->
  <if test="time1!='' and time2!='' and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null and shopId==null and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
  </if>
  <!-- 2.(12)pay+code -->
  <if test="pay!=null and code!='' and owner_id !=null and day==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
  </if>
  <!-- 2.(16)payCalendar+code 关联查询,在where外面 -->
  <if test="time3!='' and time4!='' and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and shopId==null and platformId==null and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
  </if>
  <!-- 2.(19)shopId+code -->
  <if test="shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 2.(21)platformId+code -->
  <if test="platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 2.(22)orderStatus+code -->
  <if test="orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and shopId==null ">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(3)day+shopId+code -->
  <if test="day!=null and shopId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(5)day+platformId+code -->
  <if test="day!=null and platformId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(6)day+orderStatus+code -->
  <if test="day!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(9)dayCalendar+shopId+code -->
  <if test="time1!='' and time2!='' and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(11)dayCalendar+platformId+code -->
  <if test="time1!='' and time2!='' and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(12)dayCalendar+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(15)pay+shopId+code -->
  <if test="pay!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(17)pay+platformId+code -->
  <if test="pay!=null and platformId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(18)pay+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.order_status=#{orderStatus} 
  </if>
  <!-- 3.(21)payCalendar+shopId+code -->
  <if test="time3!='' and time4!='' and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(23)payCalendar+platformId+code -->
  <if test="time3!='' and time4!='' and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(24)payCalendar+orderStatus+code -->
  <if test="time3!='' and time4!='' and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and platformId==null and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(26)platformId+shopId+code -->
  <if test="platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}     
  </if>
  <!-- 3.(27)platformId+orderStatus+code -->
  <if test="platformId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
  </if>
   <!-- 3.(28)shopId+orderStatus+code -->
  <if test="shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
  </if> 
  <!-- 4.(2)day+shopId+platformId+code -->
  <if test="day!=null and shopId!=null and platformId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}        
  </if>
  <!-- 4.(3)day+shopId+orderStatus+code -->
  <if test="day!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day} 
  </if>
  <!-- 4.(4)day+platformId+orderStatus+code -->
  <if test="day!=null and platformId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
  </if>
  <!-- 4.(6)dayCalendar+shopId+platformId+code 关联查询,在where外面 -->
  <if test="time1!='' and time2!='' and platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})      
  </if>
  <!-- 4.(7)dayCalendar+shopId+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})  
  </if>
  <!-- 4.(8)dayCalendar+platformId+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
  </if>
  <!-- 4.(10)pay+shopId+platformId+code -->
  <if test="pay!=null and platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}   
  </if>
  <!-- 4.(11)pay+shopId+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay} 
  </if>
  <!-- 4.(12)pay+platformId+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and platformId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
  </if>
  <!-- 4.(14)payCalendar+shopId+platformId+code -->
   <if test="time3!='' and time4!='' and code!='' and platformId!=null and shopId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(15)payCalendar+shopId+orderStatus+code -->
   <if test="time3!='' and time4!='' and code!='' and orderStatus!=null and shopId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and platformId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(16)payCalendar+platformId+orderStatus+code -->
   <if test="time3!='' and time4!='' and code!='' and orderStatus!=null and platformId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and shopId==null">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(17)platformId+shopId+orderStatus+code 关联查询,在where外面 -->
   <if test="shopId!=null and platformId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' ">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}        
   </if>
    <!--  5.五个条件(种) -->
   <!-- (1)day+shopId+platformId+orderStatus+code -->
   <if test="day!=null and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4==''">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
   </if>
   <!-- (2)dayCalendar+shopId+platformId+orderStatus+code -->
   <if test="time1!='' and time2!='' and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' ">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
   </if>
   <!-- (3)pay+shopId+platformId+orderStatus+code -->
   <if test="pay!=null and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4==''">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
   </if>
   <!-- (4)payCalendar+shopId+platformId+orderStatus+code -->
   <if test="time3!='' and time4!='' and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2==''">
        JOIN item_common_info c
        ON c.id = b.order_item_id
        WHERE a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
</sql>
<sql id="data_if_code">
  <!-- 1.(8)code -->
    <if test="code!='' and owner_id!=null and day==null and pay==null and shopId==null and platformId==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">        		 					      
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
    </if>
  <!-- 2.(4)day+code -->
  <if test="day!=null and code!='' and owner_id !=null and pay==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
  </if> 
  <!-- 2.(8)dayCalendar+code -->
  <if test="time1!='' and time2!='' and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null and shopId==null and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
  </if>
  <!-- 2.(12)pay+code -->
  <if test="pay!=null and code!='' and owner_id !=null and day==null and shopId==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
  </if>
  <!-- 2.(16)payCalendar+code 关联查询,在where外面 -->
  <if test="time3!='' and time4!='' and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and shopId==null and platformId==null and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
  </if>
  <!-- 2.(19)shopId+code -->
  <if test="shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 2.(21)platformId+code -->
  <if test="platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 2.(22)orderStatus+code -->
  <if test="orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and shopId==null ">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(3)day+shopId+code -->
  <if test="day!=null and shopId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(5)day+platformId+code -->
  <if test="day!=null and platformId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(6)day+orderStatus+code -->
  <if test="day!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(9)dayCalendar+shopId+code -->
  <if test="time1!='' and time2!='' and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(11)dayCalendar+platformId+code -->
  <if test="time1!='' and time2!='' and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(12)dayCalendar+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(15)pay+shopId+code -->
  <if test="pay!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(17)pay+platformId+code -->
  <if test="pay!=null and platformId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(18)pay+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
        AND a.order_status=#{orderStatus} 
  </if>
  <!-- 3.(21)payCalendar+shopId+code -->
  <if test="time3!='' and time4!='' and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.shop_id=#{shopId}
  </if>
  <!-- 3.(23)payCalendar+platformId+code -->
  <if test="time3!='' and time4!='' and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.platform_id=#{platformId}
  </if>
  <!-- 3.(24)payCalendar+orderStatus+code -->
  <if test="time3!='' and time4!='' and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and platformId==null and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
        AND a.order_status=#{orderStatus}
  </if>
  <!-- 3.(26)platformId+shopId+code -->
  <if test="platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}     
  </if>
  <!-- 3.(27)platformId+orderStatus+code -->
  <if test="platformId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">

        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
  </if>
   <!-- 3.(28)shopId+orderStatus+code -->
  <if test="shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">

        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
  </if> 
  <!-- 4.(2)day+shopId+platformId+code -->
  <if test="day!=null and shopId!=null and platformId!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}        
  </if>
  <!-- 4.(3)day+shopId+orderStatus+code -->
  <if test="day!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day} 
  </if>
  <!-- 4.(4)day+platformId+orderStatus+code -->
  <if test="day!=null and platformId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
  </if>
  <!-- 4.(6)dayCalendar+shopId+platformId+code 关联查询,在AND外面 -->
  <if test="time1!='' and time2!='' and platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})      
  </if>
  <!-- 4.(7)dayCalendar+shopId+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and shopId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})  
  </if>
  <!-- 4.(8)dayCalendar+platformId+orderStatus+code -->
  <if test="time1!='' and time2!='' and orderStatus!=null and platformId!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
  </if>
  <!-- 4.(10)pay+shopId+platformId+code -->
  <if test="pay!=null and platformId!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}   
  </if>
  <!-- 4.(11)pay+shopId+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and shopId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay} 
  </if>
  <!-- 4.(12)pay+platformId+orderStatus+code -->
  <if test="pay!=null and orderStatus!=null and platformId!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4=='' and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
  </if>
  <!-- 4.(14)payCalendar+shopId+platformId+code -->
   <if test="time3!='' and time4!='' and code!='' and platformId!=null and shopId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and orderStatus==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(15)payCalendar+shopId+orderStatus+code -->
   <if test="time3!='' and time4!='' and code!='' and orderStatus!=null and shopId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and platformId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(16)payCalendar+platformId+orderStatus+code -->
   <if test="time3!='' and time4!='' and code!='' and orderStatus!=null and platformId!=null and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and shopId==null">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
   <!-- 4.(17)platformId+shopId+orderStatus+code 关联查询,在AND外面 -->
   <if test="shopId!=null and platformId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2=='' and time3=='' and time4=='' ">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}        
   </if>
    <!--  5.五个条件(种) -->
   <!-- (1)day+shopId+platformId+orderStatus+code -->
   <if test="day!=null and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and pay==null and time1=='' and time2=='' and time3=='' and time4==''">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_create)&lt;=#{day}
   </if>
   <!-- (2)dayCalendar+shopId+platformId+orderStatus+code -->
   <if test="time1!='' and time2!='' and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time3=='' and time4=='' ">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_create)&gt;=TO_DAYS(#{time1})
        AND TO_DAYS(a.order_create)&lt;=TO_DAYS(#{time2})
   </if>
   <!-- (3)pay+shopId+platformId+orderStatus+code -->
   <if test="pay!=null and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and time1=='' and time2=='' and time3=='' and time4==''">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(NOW())-TO_DAYS(a.order_pay)&lt;=#{pay}
   </if>
   <!-- (4)payCalendar+shopId+platformId+orderStatus+code -->
   <if test="time3!='' and time4!='' and platformId!=null and shopId!=null and orderStatus!=null and code!='' and owner_id !=null and day==null and pay==null and time1=='' and time2==''">
        AND a.owner_id=b.owner_id=c.owner_id=#{owner_id}        
        AND a.platform_id=#{platformId}
        AND a.shop_id=#{shopId}
        AND a.order_status=#{orderStatus}
        AND c.erp_item_num=#{code}
        AND TO_DAYS(a.order_pay)&gt;=TO_DAYS(#{time3})
        AND TO_DAYS(a.order_pay)&lt;=TO_DAYS(#{time4})
   </if>
</sql>
</mapper>